<!doctype html>
<html>

<head>
    <meta charset=utf-8>
    <meta name=description>
    <meta name=viewport content="width=device-width, initial-scale=1">
    <title>bootstrap waterfall</title>
    <link rel=stylesheet href=styles/main.css> </head>

<body>
    <h1></h1>
    <div class=container>
        <div class=waterfall> </div>
    </div>
    <script src=scripts/vendor.js></script>
    <script src=bootstrap-waterfall.js></script>
    <!-- 首次请求 -->
    <script id=waterfall-template type=text/template></script>
    <!-- 滚动到底部请求 -->
    <script id=another-template type=text/template></script>
    <script>
        // data1是第一次首屏第一次请求的数据，data2是当滚动到底部的时候再次请求的数据，
        var pageNum = 0;
        var data = [{
            img: "images/1.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/2.JPG",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/3.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/4.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/5.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/5.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/6.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/7.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/8.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/9.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/10.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/11.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/12.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/13.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/14.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/15.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/16.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, {
            img: "images/17.jpg",
            avatar: "images/avatar_30.png",
            name: "hhh",
            desc: "我是第一次请求来的"
        }, ]
        var data2 = [{
            img: "images/18.jpg",
            avatar: "images/avatar_30.png",
            name: "long",
            desc: "我是第二次请求的数据"
        }, {
            img: "images/19.jpg",
            avatar: "images/avatar_30.png",
            name: "long",
            desc: "我是第二次请求的数据"
        }, {
            img: "images/20.jpg",
            avatar: "images/avatar_30.png",
            name: "long",
            desc: "我是第二次请求的数据"
        }, {
            img: "images/1.jpg",
            avatar: "images/avatar_30.png",
            name: "long",
            desc: "我是第二次请求的数据"
        }]
        var commentHtml1 = ``
        var commentHtml2 = ``
        data.forEach(function(val, i) {
            commentHtml1 += `<ul class="list-group" onclick="show(${i})">
            <li class="list-group-item">
                <a href="javascript:;"> <img src=` + data[i].img + ` /> </a>
            </li>
            <li class="list-group-item"> <button type="button" class="btn btn-default btn-xs" title="thumb up"><span class="glyphicon glyphicon-thumbs-up"></span></button> <button type="button" class="btn btn-default btn-xs" title="thumb down"><span class="glyphicon glyphicon-thumbs-down"></span></button>                <button type="button" class="btn btn-default btn-xs pull-right" title="pin"><span class="glyphicon glyphicon-pushpin"></span></button> </li>
            <li class="list-group-item">
                <div class="media">
                    <div class="media-left">
                        <a href="javascript:;"> <img class="media-object img-rounded" style="width: 30px; height: 30px;" src=` + data[i].avatar + ` /> </a>
                    </div>
                    <div class="media-body">
                        <h5 class="media-heading">` + data[i].name + `</h5> <small>` + data[i].desc + `</small> </div>
                </div>
            </li>
        </ul>`;
        })
        data2.forEach(function(val, i) {
            commentHtml2 += `<ul class="list-group" onclick="show(${i})">
            <li class="list-group-item">
                <a href="javascript:;"> <img src=` + data2[i].img + ` /> </a>
            </li>
            <li class="list-group-item"> <button type="button" class="btn btn-default btn-xs" title="thumb up"><span class="glyphicon glyphicon-thumbs-up"></span></button> <button type="button" class="btn btn-default btn-xs" title="thumb down"><span class="glyphicon glyphicon-thumbs-down"></span></button>                <button type="button" class="btn btn-default btn-xs pull-right" title="pin"><span class="glyphicon glyphicon-pushpin"></span></button> </li>
            <li class="list-group-item">
                <div class="media">
                    <div class="media-left">
                        <a href="javascript:;"> <img class="media-object img-rounded" style="width: 30px; height: 30px;" src=` + data2[i].avatar + ` /> </a>
                    </div>
                    <div class="media-body">
                        <h5 class="media-heading">` + data2[i].name + `</h5> <small>` + data2[i].desc + `</small> </div>
                </div>
            </li>
        </ul>`;
        })
        $('#waterfall-template').html(commentHtml1)
        $('#another-template').html(commentHtml2)

        $('.waterfall')
            .data('bootstrap-waterfall-template', $('#waterfall-template').html())
            .on('finishing.mystist.waterfall', function() {
                if (pageNum >= 2) { //如果大于2不再请求
                    return;
                }
                setTimeout(function() { // simulate ajax
                    $('.waterfall').data('mystist.waterfall').addPins($($('#another-template').html()))
                    pageNum++
                }, 100);
            })
            .waterfall()
    </script>
</body>

</html>